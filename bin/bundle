#!/usr/bin/bash

if ! command -v pp &> /dev/null; then
    echo "Error: 'Par::Packer' is not installed."
    exit 1
fi

script_dir="$(dirname "$(realpath "$0")")"

# Set environment to production in config file
echo "production" > "$script_dir/../src/environment.conf"

# Bundle with the config file included
pp -x -c -a "$script_dir/../src/environment.conf;environment.conf" "$script_dir/../src/run.pl" -o "$script_dir/../froogle"

# Restore to development for local development
echo "development" > "$script_dir/../src/environment.conf"
